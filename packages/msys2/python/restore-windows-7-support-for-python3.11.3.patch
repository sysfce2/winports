diff -au a/Modules/_winapi.c b/Modules/_winapi.c
--- a/Modules/_winapi.c	2023-04-05 00:22:17.000000000 +0200
+++ b/Modules/_winapi.c	2023-05-25 02:37:15.647669800 +0200
@@ -41,6 +41,11 @@
 
 #define WINDOWS_LEAN_AND_MEAN
 #include "windows.h"
+/* winnls.h */
+#if WINVER < 0x0602 // Windows 7 or erarlier
+#define LCMAP_SORTHANDLE 0x20000000
+#define LCMAP_HASH 0x00040000
+#endif
 #include <crtdbg.h>
 #include "winreparse.h"
 
diff -au a/Modules/getpath.c b/Modules/getpath.c
--- a/Modules/getpath.c	2023-04-05 00:22:17.000000000 +0200
+++ b/Modules/getpath.c	2023-05-25 03:06:59.970727300 +0200
@@ -12,6 +12,7 @@
 #ifdef MS_WINDOWS
 #  include <windows.h>            // GetFullPathNameW(), MAX_PATH
 #  include <pathcch.h>
+#  include <Shlwapi.h>
 #endif
 
 #ifdef __APPLE__
@@ -233,11 +234,21 @@
 #ifdef MS_WINDOWS
         const wchar_t *ext;
         DWORD attr = GetFileAttributesW(path);
+  #if WINVER >= 0x0602 // Windows 8 or greater
         r = (attr != INVALID_FILE_ATTRIBUTES) &&
             !(attr & FILE_ATTRIBUTE_DIRECTORY) &&
             SUCCEEDED(PathCchFindExtension(path, cchPath + 1, &ext)) &&
             (CompareStringOrdinal(ext, -1, L".exe", -1, 1 /* ignore case */) == CSTR_EQUAL)
             ? Py_True : Py_False;
+  #else // Windows 7
+        ext = PathFindExtensionW(path);
+        r = (attr != INVALID_FILE_ATTRIBUTES) &&
+            !(attr & FILE_ATTRIBUTE_DIRECTORY) &&
+            (ext != NULL) &&
+            (CompareStringOrdinal(ext, -1, L".exe", -1, 1 /* ignore case */) == CSTR_EQUAL)
+            ? Py_True : Py_False;
+      }
+  #endif
 #else
         struct stat st;
         r = (_Py_wstat(path, &st) == 0) &&
diff -au a/Modules/posixmodule.c b/Modules/posixmodule.c
--- a/Modules/posixmodule.c	2023-04-05 00:22:17.000000000 +0200
+++ b/Modules/posixmodule.c	2023-05-25 03:07:07.984185600 +0200
@@ -16,6 +16,7 @@
 #ifdef MS_WINDOWS
 #  include <windows.h>
 #  include <pathcch.h>
+#  include <Shlwapi.h>
 #  include <lmcons.h>             // UNLEN
 #  include "osdefs.h"             // SEP
 #  define HAVE_SYMLINK
@@ -4499,7 +4500,14 @@
     }
 
     Py_BEGIN_ALLOW_THREADS
+#if WINVER >= 0x0602 // Windows 8 or greater
     ret = PathCchSkipRoot(buffer, &end);
+#else // Windows 7
+    end = PathSkipRootW(buffer);
+    if (!end) {
+        ret = E_FAIL;
+    }
+#endif
     Py_END_ALLOW_THREADS
     if (FAILED(ret)) {
         result = Py_BuildValue("sO", "", path->object);
diff -au a/PC/launcher2.c b/PC/launcher2.c
--- a/PC/launcher2.c	2023-04-05 00:22:17.000000000 +0200
+++ b/PC/launcher2.c	2023-05-25 03:05:51.267797700 +0200
@@ -10,6 +10,7 @@
 
 #include <windows.h>
 #include <pathcch.h>
+#include <Shlwapi.h>
 #include <fcntl.h>
 #include <io.h>
 #include <shlobj.h>
@@ -188,9 +189,15 @@
 bool
 join(wchar_t *buffer, size_t bufferLength, const wchar_t *fragment)
 {
+#if WINVER >= 0x0602 // Windows 8 or greater
     if (SUCCEEDED(PathCchCombineEx(buffer, bufferLength, buffer, fragment, PATHCCH_ALLOW_LONG_PATHS))) {
         return true;
     }
+#else // Windows 7
+    if (PathCombineW(buffer, buffer, fragment)) {
+        return true;
+    }
+#endif
     return false;
 }
 
@@ -853,6 +860,7 @@
             winerror(0, L"Failed to read from %s\n", iniPath);
         }
     }
+#if WINVER >= 0x0602 // Windows 8 or greater
     if (GetModuleFileNameW(NULL, iniPath, MAXLEN) &&
         SUCCEEDED(PathCchRemoveFileSpec(iniPath, MAXLEN)) &&
         join(iniPath, MAXLEN, L"py.ini")) {
@@ -867,6 +875,22 @@
             winerror(0, L"Failed to read from %s\n", iniPath);
         }
     }
+#else // Windows 7
+    if (GetModuleFileNameW(NULL, iniPath, MAXLEN) &&
+        PathRemoveFileSpecW(iniPath) &&
+        join(iniPath, MAXLEN, L"py.ini")) {
+        debug(L"# Reading from %s for %s/%s\n", iniPath, section, settingName);
+        n = GetPrivateProfileStringW(section, settingName, NULL, buffer, MAXLEN, iniPath);
+        if (n) {
+            debug(L"# Found %s in %s\n", settingName, iniPath);
+            return n;
+        } else if (GetLastError() == ERROR_FILE_NOT_FOUND) {
+            debug(L"# Did not find file %s\n", iniPath);
+        } else {
+            winerror(0, L"Failed to read from %s\n", iniPath);
+        }
+    }
+#endif
     return 0;
 }
 
@@ -921,6 +945,7 @@
     }
     *pC = L'\0';
 
+#if WINVER >= 0x0602 // Windows 8 or greater
     if (!GetCurrentDirectoryW(MAXLEN, buffer) ||
         wcsncpy_s(script, MAXLEN, search->scriptFile, search->scriptFileLength) ||
         FAILED(PathCchCombineEx(buffer, MAXLEN, buffer, script,
@@ -931,6 +956,16 @@
     ) {
         return RC_NO_MEMORY;
     }
+#else // Windows 7
+    if (!GetCurrentDirectoryW(MAXLEN, buffer) ||
+        wcsncpy_s(script, MAXLEN, search->scriptFile, search->scriptFileLength) ||
+        !PathCombineW(buffer, buffer, script) ||
+        !PathRemoveFileSpecW(buffer) ||
+        !PathCombineW(buffer, buffer, command)
+    ) {
+        return RC_NO_MEMORY;
+    }
+#endif
 
     int n = (int)wcsnlen(buffer, MAXLEN);
     wchar_t *path = allocSearchInfoBuffer(search, n + 1);
@@ -1419,9 +1454,15 @@
         return RC_NO_MEMORY;
     }
 
+#if WINVER >= 0x0602 // Windows 8 or greater
     if (FAILED(PathCchCombineEx(buffer, MAXLEN, installDir, fragmentBuffer, PATHCCH_ALLOW_LONG_PATHS))) {
         return RC_NO_MEMORY;
     }
+#else // Windows 7
+    if (!PathCombineW(buffer, installDir, fragmentBuffer)) {
+        return RC_NO_MEMORY;
+    }
+#endif
 
     return copyWstr(dest, buffer);
 }
diff -au a/PC/pyconfig.h b/PC/pyconfig.h
--- a/PC/pyconfig.h	2023-04-05 00:22:17.000000000 +0200
+++ b/PC/pyconfig.h	2023-05-24 06:47:53.178970100 +0200
@@ -142,8 +142,8 @@
 
 /* set the version macros for the windows headers */
 /* Python 3.9+ requires Windows 8 or greater */
-#define Py_WINVER 0x0602 /* _WIN32_WINNT_WIN8 */
-#define Py_NTDDI NTDDI_WIN8
+#define Py_WINVER 0x0601 /* _WIN32_WINNT_WIN7 */
+#define Py_NTDDI NTDDI_WIN7
 
 /* We only set these values when building Python - we don't want to force
    these values on extensions, as that will affect the prototypes and
diff -au a/PCbuild/_freeze_module.vcxproj b/PCbuild/_freeze_module.vcxproj
--- a/PCbuild/_freeze_module.vcxproj	2023-04-05 00:22:17.000000000 +0200
+++ b/PCbuild/_freeze_module.vcxproj	2023-05-25 02:48:02.944693100 +0200
@@ -94,7 +94,7 @@
     </ClCompile>
     <Link>
       <SubSystem>Console</SubSystem>
-      <AdditionalDependencies>version.lib;ws2_32.lib;pathcch.lib;bcrypt.lib;%(AdditionalDependencies)</AdditionalDependencies>
+      <AdditionalDependencies>version.lib;ws2_32.lib;shlwapi.lib;bcrypt.lib;%(AdditionalDependencies)</AdditionalDependencies>
       <LinkTimeCodeGeneration>Default</LinkTimeCodeGeneration>
     </Link>
   </ItemDefinitionGroup>
diff -au a/PCbuild/pylauncher.vcxproj b/PCbuild/pylauncher.vcxproj
--- a/PCbuild/pylauncher.vcxproj	2023-04-05 00:22:17.000000000 +0200
+++ b/PCbuild/pylauncher.vcxproj	2023-05-25 02:48:08.460008500 +0200
@@ -95,7 +95,7 @@
       <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
     </ClCompile>
     <Link>
-      <AdditionalDependencies>shell32.lib;pathcch.lib;%(AdditionalDependencies)</AdditionalDependencies>
+      <AdditionalDependencies>shell32.lib;shlwapi.lib;%(AdditionalDependencies)</AdditionalDependencies>
       <SubSystem>Console</SubSystem>
     </Link>
   </ItemDefinitionGroup>
diff -au a/PCbuild/pythoncore.vcxproj b/PCbuild/pythoncore.vcxproj
--- a/PCbuild/pythoncore.vcxproj	2023-04-05 00:22:17.000000000 +0200
+++ b/PCbuild/pythoncore.vcxproj	2023-05-25 02:48:15.341402100 +0200
@@ -106,7 +106,7 @@
       <PreprocessorDefinitions Condition="$(IncludeExternals)">_Py_HAVE_ZLIB;%(PreprocessorDefinitions)</PreprocessorDefinitions>
     </ClCompile>
     <Link>
-      <AdditionalDependencies>version.lib;ws2_32.lib;pathcch.lib;bcrypt.lib;%(AdditionalDependencies)</AdditionalDependencies>
+      <AdditionalDependencies>version.lib;ws2_32.lib;shlwapi.lib;bcrypt.lib;%(AdditionalDependencies)</AdditionalDependencies>
     </Link>
   </ItemDefinitionGroup>
   <ItemGroup>
diff -au a/PCbuild/pywlauncher.vcxproj b/PCbuild/pywlauncher.vcxproj
--- a/PCbuild/pywlauncher.vcxproj	2023-04-05 00:22:17.000000000 +0200
+++ b/PCbuild/pywlauncher.vcxproj	2023-05-24 21:40:34.634510100 +0200
@@ -95,7 +95,7 @@
       <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
     </ClCompile>
     <Link>
-      <AdditionalDependencies>shell32.lib;pathcch.lib;%(AdditionalDependencies)</AdditionalDependencies>
+      <AdditionalDependencies>shell32.lib;shlwapi.lib;%(AdditionalDependencies)</AdditionalDependencies>
       <SubSystem>Windows</SubSystem>
     </Link>
   </ItemDefinitionGroup>
diff -au a/Python/fileutils.c b/Python/fileutils.c
--- a/Python/fileutils.c	2023-04-05 00:22:17.000000000 +0200
+++ b/Python/fileutils.c	2023-05-25 03:07:32.504588100 +0200
@@ -9,6 +9,7 @@
 #  include <malloc.h>
 #  include <windows.h>
 #  include <pathcch.h>            // PathCchCombineEx
+#  include <Shlwapi.h>
 extern int winerror_to_errno(int);
 #endif
 
@@ -2005,7 +2006,15 @@
 {
 #ifdef MS_WINDOWS
     const wchar_t *tail;
+  #if WINVER >= 0x0602 // Windows 8 or greater
     HRESULT hr = PathCchSkipRoot(path, &tail);
+  #else // Windows 7
+	HRESULT hr = NULL;
+    tail = PathSkipRootW(path);
+    if (!tail) {
+        hr = E_FAIL;
+    }
+  #endif
     if (FAILED(hr) || path == tail) {
         return 0;
     }
@@ -2093,10 +2102,16 @@
              const wchar_t *dirname, const wchar_t *relfile)
 {
 #ifdef MS_WINDOWS
+  #if WINVER >= 0x0602 // Windows 8 or greater
     if (FAILED(PathCchCombineEx(buffer, bufsize, dirname, relfile,
         PATHCCH_ALLOW_LONG_PATHS))) {
         return -1;
     }
+  #else // Windows 7
+    if (!PathCombineW(buffer, dirname, relfile)) {
+        return -1;
+    }
+  #endif
 #else
     assert(!_Py_isabs(relfile));
     size_t dirlen = wcslen(dirname);
